// 
//       ▄▀█ █▀▀ █▀▀ █▀▀ █▀ █▀ █ █▄░█ █▀▀   ▀█▀ █░█ █ █▀   █▀▀ █ █░░ █▀▀   █▄█ █▀█ █░█   ▄▀█ █▀█ █▀▀
//       █▀█ █▄▄ █▄▄ ██▄ ▄█ ▄█ █ █░▀█ █▄█   ░█░ █▀█ █ ▄█   █▀░ █ █▄▄ ██▄   ░█░ █▄█ █▄█   █▀█ █▀▄ ██▄
// 
//                             █▀ █░█ █▄▄ ░░█ █▀▀ █▀▀ ▀█▀   ▀█▀ █▀█
//                             ▄█ █▄█ █▄█ █▄█ ██▄ █▄▄ ░█░   ░█░ █▄█
// 
// ░█████╗░████████╗████████╗██████╗░██╗██████╗░██╗░░░██╗████████╗██╗░█████╗░███╗░░██╗░░░░░░
// ██╔══██╗╚══██╔══╝╚══██╔══╝██╔══██╗██║██╔══██╗██║░░░██║╚══██╔══╝██║██╔══██╗████╗░██║░░░░░░
// ███████║░░░██║░░░░░░██║░░░██████╔╝██║██████╦╝██║░░░██║░░░██║░░░██║██║░░██║██╔██╗██║█████╗
// ██╔══██║░░░██║░░░░░░██║░░░██╔══██╗██║██╔══██╗██║░░░██║░░░██║░░░██║██║░░██║██║╚████║╚════╝
// ██║░░██║░░░██║░░░░░░██║░░░██║░░██║██║██████╦╝╚██████╔╝░░░██║░░░██║╚█████╔╝██║░╚███║░░░░░░
// ╚═╝░░╚═╝░░░╚═╝░░░░░░╚═╝░░░╚═╝░░╚═╝╚═╝╚═════╝░░╚═════╝░░░░╚═╝░░░╚═╝░╚════╝░╚═╝░░╚══╝░░░░░░
// 
// ███╗░░██╗░█████╗░███╗░░██╗░█████╗░░█████╗░███╗░░░███╗███╗░░░███╗███████╗██████╗░░█████╗░██╗░█████╗░██╗░░░░░
// ████╗░██║██╔══██╗████╗░██║██╔══██╗██╔══██╗████╗░████║████╗░████║██╔════╝██╔══██╗██╔══██╗██║██╔══██╗██║░░░░░
// ██╔██╗██║██║░░██║██╔██╗██║██║░░╚═╝██║░░██║██╔████╔██║██╔████╔██║█████╗░░██████╔╝██║░░╚═╝██║███████║██║░░░░░
// ██║╚████║██║░░██║██║╚████║██║░░██╗██║░░██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝░░██╔══██╗██║░░██╗██║██╔══██║██║░░░░░
// ██║░╚███║╚█████╔╝██║░╚███║╚█████╔╝╚█████╔╝██║░╚═╝░██║██║░╚═╝░██║███████╗██║░░██║╚█████╔╝██║██║░░██║███████╗
// ╚═╝░░╚══╝░╚════╝░╚═╝░░╚══╝░╚════╝░░╚════╝░╚═╝░░░░░╚═╝╚═╝░░░░░╚═╝╚══════╝╚═╝░░╚═╝░╚════╝░╚═╝╚═╝░░╚═╝╚══════╝
// 
// ░░██╗██╗░░░░█████╗░
// ░██╔╝██║░░░██╔══██╗
// ██╔╝░██║░░░██║░░██║
// ███████║░░░██║░░██║
// ╚════██║██╗╚█████╔╝
// ░░░░░╚═╝╚═╝░╚════╝░
// 
// ██╗███╗░░██╗████████╗███████╗██████╗░███╗░░██╗░█████╗░████████╗██╗░█████╗░███╗░░██╗░█████╗░██╗░░░░░
// ██║████╗░██║╚══██╔══╝██╔════╝██╔══██╗████╗░██║██╔══██╗╚══██╔══╝██║██╔══██╗████╗░██║██╔══██╗██║░░░░░
// ██║██╔██╗██║░░░██║░░░█████╗░░██████╔╝██╔██╗██║███████║░░░██║░░░██║██║░░██║██╔██╗██║███████║██║░░░░░
// ██║██║╚████║░░░██║░░░██╔══╝░░██╔══██╗██║╚████║██╔══██║░░░██║░░░██║██║░░██║██║╚████║██╔══██║██║░░░░░
// ██║██║░╚███║░░░██║░░░███████╗██║░░██║██║░╚███║██║░░██║░░░██║░░░██║╚█████╔╝██║░╚███║██║░░██║███████╗
// ╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚══════╝╚═╝░░╚═╝╚═╝░░╚══╝╚═╝░░╚═╝░░░╚═╝░░░╚═╝░╚════╝░╚═╝░░╚══╝╚═╝░░╚═╝╚══════╝
// 
// █─▄▄▄─█─▄▄▄─███▄─▄─▀█▄─█─▄█▀▀▀▀▀██▄─▀█▄─▄█─▄▄▄─███░█░██████─▄▄─█
// █─███▀█─███▀████─▄─▀██▄─▄██████████─█▄▀─██─███▀███▄▄░██░░██─██─█
// ▀▄▄▄▄▄▀▄▄▄▄▄▀▀▀▄▄▄▄▀▀▀▄▄▄▀▀▀▀▀▀▀▀▀▄▄▄▀▀▄▄▀▄▄▄▄▄▀▀▀▀▄▄▄▀▄▄▀▀▄▄▄▄▀
// 
// ▀█▀ █░█ █ █▀   █░░ █ █▀▀ █▀▀ █▄░█ █▀ █▀▀   █▀█ █▀▀ █▀█ █░█ █ █▀█ █▀▀ █▀   ▀█▀ █░█ ▄▀█ ▀█▀
// ░█░ █▀█ █ ▄█   █▄▄ █ █▄▄ ██▄ █░▀█ ▄█ ██▄   █▀▄ ██▄ ▀▀█ █▄█ █ █▀▄ ██▄ ▄█   ░█░ █▀█ █▀█ ░█░
// 
// █▀█ █▀▀ █░█ █▀ █▀▀ █▀█ █▀   █▀▀ █ █░█ █▀▀   █▀▀ █▀█ █▀▀ █▀▄ █ ▀█▀   ▀█▀ █▀█   ▀█▀ █░█ █▀▀
// █▀▄ ██▄ █▄█ ▄█ ██▄ █▀▄ ▄█   █▄█ █ ▀▄▀ ██▄   █▄▄ █▀▄ ██▄ █▄▀ █ ░█░   ░█░ █▄█   ░█░ █▀█ ██▄
// 
// █▀▀ █▀█ █▀▀ ▄▀█ ▀█▀ █▀█ █▀█ ░   █ ▀█▀   ▄▀█ █░░ █░░ █▀█ █░█░█ █▀   █▀█ █▀▀ █░█ █▀ █▀▀ █▀█ █▀   ▀█▀ █▀█
// █▄▄ █▀▄ ██▄ █▀█ ░█░ █▄█ █▀▄ ▄   █ ░█░   █▀█ █▄▄ █▄▄ █▄█ ▀▄▀▄▀ ▄█   █▀▄ ██▄ █▄█ ▄█ ██▄ █▀▄ ▄█   ░█░ █▄█
// 
// █▀▄ █ █▀ ▀█▀ █▀█ █ █▄▄ █░█ ▀█▀ █▀▀ ░   █▀█ █▀▀ █▀▄▀█ █ ▀▄▀ ░   ▄▀█ █▀▄ ▄▀█ █▀█ ▀█▀ ░   ▄▀█ █▄░█ █▀▄
// █▄▀ █ ▄█ ░█░ █▀▄ █ █▄█ █▄█ ░█░ ██▄ █   █▀▄ ██▄ █░▀░█ █ █░█ █   █▀█ █▄▀ █▀█ █▀▀ ░█░ █   █▀█ █░▀█ █▄▀
// 
// █▄▄ █░█ █ █░░ █▀▄   █░█ █▀█ █▀█ █▄░█   ▀█▀ █░█ █▀▀   █▀▄▀█ ▄▀█ ▀█▀ █▀▀ █▀█ █ ▄▀█ █░░   █ █▄░█   ▄▀█ █▄░█ █▄█
// █▄█ █▄█ █ █▄▄ █▄▀   █▄█ █▀▀ █▄█ █░▀█   ░█░ █▀█ ██▄   █░▀░█ █▀█ ░█░ ██▄ █▀▄ █ █▀█ █▄▄   █ █░▀█   █▀█ █░▀█ ░█░
// 
// █▀▄▀█ █▀▀ █▀▄ █ █░█ █▀▄▀█   █▀█ █▀█   █▀▀ █▀█ █▀█ █▀▄▀█ ▄▀█ ▀█▀ ░   █▀▀ █▀█ █▀█
// █░▀░█ ██▄ █▄▀ █ █▄█ █░▀░█   █▄█ █▀▄   █▀░ █▄█ █▀▄ █░▀░█ █▀█ ░█░ █   █▀░ █▄█ █▀▄
// 
// █▄░█ █▀█ █▄░█ █▀▀ █▀█ █▀▄▀█ █▀▄▀█ █▀▀ █▀█ █▀▀ █ ▄▀█ █░░   █▀█ █░█ █▀█ █▀█ █▀█ █▀ █▀▀ █▀   █▀█ █▄░█ █░░ █▄█ ░
// █░▀█ █▄█ █░▀█ █▄▄ █▄█ █░▀░█ █░▀░█ ██▄ █▀▄ █▄▄ █ █▀█ █▄▄   █▀▀ █▄█ █▀▄ █▀▀ █▄█ ▄█ ██▄ ▄█   █▄█ █░▀█ █▄▄ ░█░ ▄
// 
using System;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Windows;
using System.Windows.Interop;
using System.Windows.Media.Imaging;

namespace Katyusha
{
    class Program
    {
        static string[] imageFiles;
        static string folderPath;

        [STAThread]
        static void Main(string[] args)
        {
            if (args.Length != 2 || args[0].Equals("--help", StringComparison.OrdinalIgnoreCase))
            {
                ShowUsage();
                return;
            }
            folderPath = args[0];
            string mode = args[1].ToLower();

            if (!IsValidFolder(folderPath))
            {
                Console.WriteLine("Invalid folder path. Please provide a valid folder path. Or use --help");
                return;
            }
            else if (folderPath.Length > 0)
            {
                Console.WriteLine(@"

                                                         .::..                                      
                                                      .:^~!!7~~^.                                   
                                                  .:~~~~!!!!~~!!!~~^^.                              
                                              .:^^~!7!7!!~~~!!!!!!!!!~~~:^                          
                                           .:~!~~77!~!7!777?!!~!~!!!!!!!!!!~~.                      
                                       .:^^~!!!~~!!!777!!!!!~7!!7!!!!!!7777!~:                      
                                    .:^~!!7!~~!!7777!!!~!~!7!~~7?7777?7!!~:.                        
                                .:^~~!~!!?7!!77!7!!~~!!!~~~777???7!!!~^:                            
                             .:^!!!~~~!!7777!!~7!~~!7~~!777????!!7!~^.                              
                         .:^~~!~!~7!!777!!!7!!~~!~!?!7777?777????????J?7!~:.                        
                     .:^^~~!~~~~~!!!!77?!77!~!~!7!777?777!!~!777777????JJJJ?7~:                     
               :~^:^^~~!!~~~~~!!77!!!!!!!777?77?7??7?!!!~:. ~77!!!!!777?????J?!^~!~!!^:.            
           .~?Y555YJ77~~~~!!!!!~7!~~~!!!~!77777???777^.    .!77!!!!!!!!?YJJJ??J?!?YYYYYYJ7!^.       
        :!J555Y5Y55Y?JJ?!?!!~!!!!~!!!~!7777????77~:~:      .!!!!!!!!!!77YJ????????JJJJJJJJJ??~::    
  .::^?Y5P55YYYYJJJYYYY5Y?7!~~!!!!~7?77????77?77!: ~       .!!!!!!!!!!!7YJ????JJYJJJJJJ????!??~~^   
 :!???J5YY5YJJ?JYYYYYYJ?J5YJJY?~7?7??7?77!7!^^^^!!~^       .!!7???J?~~!!JYYYYY555J?J????JJJ????7!:  
  ^~777!!Y7J5YYYYYJ??YY5YY55YJYP5?77~!!?!. ::..:???:.:^~~~^~~~?JJ???~~!!JJYPP5PP5JJJJJJJJJJ?77?~:.  
   :^^~!777?!J5J?JYYYY55YJY5PGPJ!~777~!!~~^^:.~7?777777!~!!~~~??????^^!!JJ5GG555YJ?7?J7~^^!777~:^^  
    .:::~!~~!7~!5JY55J?J5GG5Y??JY5J!!77!!~~!!!!!~!^!!!~^:^^~~^7?JYYY~^~7YY555YYYYJ7777::~?55YYY! .  
      .:::^~~!!!~~???PGPY?!7JYP5J7!!7!!!77!!^:^~!!~!~:^7!^::^J55YJJJY?~7YYYYYJJJJ??7J~.75PJYJJJ5.   
         ..:^^:~!7!!7J??JY55JJ777???J7!~^~!~~^^^^^^^:  ~J~^~J5Y?77~!YY~?JJJJJJYYYJJ7!:^JPYJYYJYJ    
           ...:::~!~^~?P5J?!~~~!77?!~~~^^^^^^^^::~7?7?7??7!!JY?!77!J5~ .^7J?!~^:.     .?5YJJJYJ:    
               .:::^~!77~:^~!~~!!!~^^~~~~!77??JJJJYYYYYYJJJ??YYJJY5J^                  .!JJ?7~.     
                   ^77!~~^^:::^~^^~!7??JJJJJJYYYYJ???JJJJ?7!JYJ?7!^                                 
                    :::~~^^^^~~~!77?JJJJJJJJJ?!^!:^?YYJ??Y5?.?7                                     
                       .~7??77!!7????JYJJJJJJJ~^^~YPJ7J7^?5?  .                                     
                         .:. :7?????YJYJ??!!J5Y^~755?7!?J55:                                        
                              :~7?J5JYY!??!^?5? :^J55YY55?:                                         
                                .:7??5Y7?!JY5?.   .^~!~^.                                           
                                    :7YYYYJ?^                                                       
                                      .:::                                                          

                               \\ █▄▀ ▄▀█ ▀█▀ █▄█ █ █ █▀ █ █ ▄▀█ //
                               // █ █ █▀█  █   █  █▄█ ▄█ █▀█ █▀█ \\

");
                switch (folderPath.ToLower())
                {
                    case "text":
                        TextMode();
                        break;
                    case "bm-8":
                        TextMode();
                        break;
                    case "fragment":
                        FragmentMode(Int32.Parse(mode));
                        break;
                    case "bm-21":
                        FragmentMode(Int32.Parse(mode));
                        break;
                }
            }
            
            try
            {
                imageFiles = GetImageFiles(folderPath);
            }
            catch (Exception e)
            {
                Console.WriteLine(e);
            }
            

            if (imageFiles.Length == 0)
            {
                Console.WriteLine("No image files found in the specified folder.");
                return;
            }

            bool capsLockEnabled = Console.CapsLock;
            MainLoop(mode, imageFiles);
        }

        static void MainLoop(string mode, string[] imageFiles)
        {
            while (true)
            {
                switch (mode.ToLower())
                {
                    // V1 Rockets

                    case "text":
                        TextMode();
                        break;
                    case "bm-8":
                        TextMode();
                        break;

                    case "normal":
                        NormalMode(imageFiles);
                        break;
                    case "bm-13":
                        NormalMode(imageFiles);
                        break;

                    case "random":
                        RandomMode(imageFiles);
                        break;
                    case "bm-18":
                        RandomMode(imageFiles);
                        break;

                    // V2 Rockets

                    case "grad":
                        FragmentMode(Int32.Parse(folderPath));
                        break;
                    case "bm-21":
                        FragmentMode(Int32.Parse(folderPath));
                        break;
                    case "uragan":
                        ConventMode(imageFiles);
                        break;
                    case "bm-27":
                        ConventMode(imageFiles);
                        break;

                    // V3 Rockets

                    case "smerch":
                        Hotlaunch(imageFiles);
                        break;
                    case "bm-30":
                        Hotlaunch(imageFiles);
                        break;

                    // Default

                    default:
                        Console.WriteLine($"Invalid mode for Payload: '{mode}'");
                        break;
                }
            }
        }

        static void NormalMode(string[] imageFiles)
        {
            foreach (string imagePath in imageFiles)
            {
                if (Console.CapsLock)
                {
                    Console.WriteLine("CapsLock is enabled. Stopping the operation.");
                    return;
                }

                ProcessImage(imagePath);
            }
        }

        static void RandomMode(string[] imageFiles)
        {
            Random random = new Random();
            foreach (string imagePath in imageFiles.OrderBy(x => random.Next()))
            {
                if (Console.CapsLock)
                {
                    Console.WriteLine("CapsLock is enabled. Stopping the operation.");
                    return;
                }

                ProcessImage(imagePath);
            }
        }

        static void TextMode()
        {
            while (true)
            {
                if (File.Exists(folderPath + "*.txt*"))
                {
                    string data = File.ReadAllText(folderPath + "*.txt*");
                    Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {data} ");
                    Clipboard.SetText(data);
                }
                else if (folderPath.Length > 0)
                {
                    Clipboard.SetText(folderPath);
                    Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {folderPath} ");
                }
                else
                {
                    Clipboard.SetDataObject(Clipboard.GetDataObject());
                    Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {Clipboard.GetDataObject()} ");
                }
            }

        }

        static void FragmentMode(int length)
        {
            while (true)
            {
                string[] variableArray = Properties.Resource.Dumper.Split(',');
                Random random = new Random();
                StringBuilder generatedText = new StringBuilder();

                for (int j = 0; j < length; j++)
                {
                    int randomIndex = random.Next(variableArray.Length);
                    generatedText.Append(variableArray[randomIndex]);
                }
                Clipboard.SetText(generatedText.ToString());
                Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {generatedText} ");
            }
        }

        static void ConventMode(string[] imageFiles)
        {
            foreach (string imagePath in imageFiles)
            {
                Random random = new Random();

                Image img = Image.FromFile(imagePath);
                Bitmap resizedImage = new Bitmap(Int16.MaxValue, Int16.MinValue, System.Drawing.Imaging.PixelFormat.Format32bppArgb);
                Graphics graphics = Graphics.FromImage(resizedImage);
                graphics.DrawImage(img, new Rectangle(0, 0, Int16.MaxValue, Int16.MinValue));
                BitmapSource bitmapSource = ConvertDrawingImageToBitmapSource(img);
                Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {bitmapSource} ");
                Clipboard.SetImage(bitmapSource);
            }
        }

        static void ProcessImage(string imagePath)
        {
            retry:
            try
            {
                System.Drawing.Image drawingImage = ConvertBitmapImageToDrawingImage(new BitmapImage(new Uri(imagePath)));
                BitmapSource bitmapSource = ConvertDrawingImageToBitmapSource(drawingImage);
                Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {imagePath} ");
                Clipboard.SetImage(bitmapSource);
            }
            catch (Exception ex)
            {
                if (ex.Message.Contains("Memory") || ex.Message.Contains("not"))
                {
                    goto retry;
                }
                Console.WriteLine($" << Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (-) => {imagePath} : {ex.Message} ");
            }
        }

        static string[] GetImageFiles(string folderPath)
        {
            return Directory.GetFiles(folderPath, "*.*", SearchOption.AllDirectories)
                .Where(file => file.ToLower().EndsWith(".jpg") ||
                               file.ToLower().EndsWith(".jpeg") ||
                               file.ToLower().EndsWith(".png") ||
                               file.ToLower().EndsWith(".gif") ||
                               file.ToLower().EndsWith(".apng"))
                .ToArray();
        }

        static bool IsValidFolder(string folderPath)
        {
            return Directory.Exists(folderPath);
        }

        static void ShowUsage()
        {
            Console.WriteLine(@"
 << Katyusha >> 
    Usage: Katyusha.exe [directory] [mode] [options]
                                  \ [mode] [options]

    Mode(s):

      v1 Rockets:

        text / BM-8                 : Uses Text Only. 

                                      Uses a text file from the directory
        [mode] [directory] [options]  if you dont have a directory it will
        text (c:\my\directory\)       use the second argument as a Text and
        bm-8 @everyone My Text!       if not it will default to your current
                                      clipboard.
        
        normal / BM-13              : Uses Images / Gif Files.

        [directory] [mode] [options]  Uses images / gif files in the specified
        normal (c:\my\directory)      directory, and will go through them top-bottom
        bm-13 (c:\my\directory)                                    

        random / BM-18              : Uses Images / Gif files in random order.

        [directory] [mode] [options]  Randomizing the image will prevent any duplicates
        random (c:\my\directory)      from making an appearance will improve efficiency
        bm-18 (c:\my\directory)

      v2 Rockets:
        
        grad / BM-21                : Uses Destructive Text.

        [mode] [int] [options]        Grad has improved destructiveness as the decendant
        grad 100                      of BM-8, Uses Bloated Unicode Text, It requires the
        bm-21 2100                    total number of text it will produce [int].

        uragan / BM-27              : Uses Destructive Images.

                                      Uragan Corrupts/Image Vortex/Image Crash the Image to
                                      the target in-order to crash the clients in the group.

      v3 Rockets:

        smerch / BM-30              : Uses sophisticated local image hosting to send to target
                                    [ Warning: Use VPN / Dynamic IP to change after an attack  ]
                                    [ This to prevent YOU from being DDoS'ed Because it uses   ]
                                    [ Your Local/Current IP, This needs to use your IP to work ] 

        [directory] [mode] [options]  Uragan a more destructive child of BM-13 and BM-18
        uragan (c:\my\directory)      Uses Images and tries to make it stretch to the
        bm-18 (c:\my\directory)       Highest limits.
");
        }
        private static System.Drawing.Image ConvertBitmapImageToDrawingImage(BitmapImage bitmapImage)
        {
            using (MemoryStream memoryStream = new MemoryStream())
            {
                BitmapEncoder encoder = new PngBitmapEncoder(); 
                encoder.Frames.Add(BitmapFrame.Create(bitmapImage));
                encoder.Save(memoryStream);
                return System.Drawing.Image.FromStream(memoryStream);
            }
        }

        private static BitmapSource ConvertDrawingImageToBitmapSource(System.Drawing.Image drawingImage)
        {
            Bitmap bitmap = new Bitmap(drawingImage);
            IntPtr hBitmap = bitmap.GetHbitmap();
            BitmapSource bitmapSource = Imaging.CreateBitmapSourceFromHBitmap(
                hBitmap,
                IntPtr.Zero,
                Int32Rect.Empty,
                BitmapSizeOptions.FromEmptyOptions());
            return bitmapSource;
        }
    
        private static void Hotlaunch(string[] imageFiles)
        {
            string directoryPath = Environment.CurrentDirectory;
            HttpListener listener = new HttpListener();
            listener.Prefixes.Add("http://localhost:8080/");
            listener.Start();

            while (true)
            {
                HttpListenerContext context = listener.GetContext();
                HttpListenerResponse response = context.Response;

                try
                {
                    string ipAddress = GetLocalIPAddress();
                    string requestedFileName = context.Request.Url.Segments[1];
                    string fileExtension = Path.GetExtension(requestedFileName).ToLower();
                    if (fileExtension == ".png" || fileExtension == ".jpg" || fileExtension == ".jpeg" || fileExtension == ".apng" || fileExtension == ".gif")
                    {
                        string filePath = Path.Combine(directoryPath, requestedFileName);
                        if (File.Exists(filePath))
                        {
                            byte[] fileBytes = File.ReadAllBytes(filePath);
                            response.OutputStream.Write(fileBytes, 0, fileBytes.Length);
                            response.ContentType = GetContentType(fileExtension);
                            response.StatusCode = 200;
                            Console.WriteLine($"<< Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (+) => {response}");
                            Clipboard.SetText($"http://{ipAddress}:8080/{requestedFileName}");
                            
                        }
                        else
                        {
                            byte[] notFoundBytes = System.Text.Encoding.UTF8.GetBytes("404 Not Found");
                            response.OutputStream.Write(notFoundBytes, 0, notFoundBytes.Length);
                            response.StatusCode = 404;
                            Console.WriteLine($"<< Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (-) => {response}");
                        }
                    }
                    else
                    {
                        byte[] badRequestBytes = System.Text.Encoding.UTF8.GetBytes("400 Bad Request");
                        response.OutputStream.Write(badRequestBytes, 0, badRequestBytes.Length);
                        response.StatusCode = 400;
                        Console.WriteLine($"<< Katyusha >> [{DateTime.Now.ToString("HH:mm")}] (-) => {response}");
                    }
                }
                catch (Exception ex)
                {
                    Console.WriteLine("Error: " + ex.Message);
                }
            }
        }

        private static string GetContentType(string fileExtension)
        {
            switch (fileExtension)
            {
                case ".png":
                    return "image/png";
                case ".jpg":
                    return "image/jpg";
                case ".jpeg":
                    return "image/jpeg";
                case ".apng":
                    return "image/apng";
                case ".gif":
                    return "image/gif";
                default:
                    return "application/octet-stream";
            }
        }

        private static string GetLocalIPAddress()
        {
            string ipAddress = "127.0.0.1"; 

            try
            {
                using (var socket = new System.Net.Sockets.TcpClient())
                {
                    socket.Connect("8.8.8.8", 53);
                    ipAddress = ((System.Net.IPEndPoint)socket.Client.LocalEndPoint).Address.ToString();
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Error getting local IP address: {ex.Message}");
            }

            return ipAddress;
        }
    }


}

// 
//       ▄▀█ █▀▀ █▀▀ █▀▀ █▀ █▀ █ █▄░█ █▀▀   ▀█▀ █░█ █ █▀   █▀▀ █ █░░ █▀▀   █▄█ █▀█ █░█   ▄▀█ █▀█ █▀▀
//       █▀█ █▄▄ █▄▄ ██▄ ▄█ ▄█ █ █░▀█ █▄█   ░█░ █▀█ █ ▄█   █▀░ █ █▄▄ ██▄   ░█░ █▄█ █▄█   █▀█ █▀▄ ██▄
// 
//                             █▀ █░█ █▄▄ ░░█ █▀▀ █▀▀ ▀█▀   ▀█▀ █▀█
//                             ▄█ █▄█ █▄█ █▄█ ██▄ █▄▄ ░█░   ░█░ █▄█
// 
// ░█████╗░████████╗████████╗██████╗░██╗██████╗░██╗░░░██╗████████╗██╗░█████╗░███╗░░██╗░░░░░░
// ██╔══██╗╚══██╔══╝╚══██╔══╝██╔══██╗██║██╔══██╗██║░░░██║╚══██╔══╝██║██╔══██╗████╗░██║░░░░░░
// ███████║░░░██║░░░░░░██║░░░██████╔╝██║██████╦╝██║░░░██║░░░██║░░░██║██║░░██║██╔██╗██║█████╗
// ██╔══██║░░░██║░░░░░░██║░░░██╔══██╗██║██╔══██╗██║░░░██║░░░██║░░░██║██║░░██║██║╚████║╚════╝
// ██║░░██║░░░██║░░░░░░██║░░░██║░░██║██║██████╦╝╚██████╔╝░░░██║░░░██║╚█████╔╝██║░╚███║░░░░░░
// ╚═╝░░╚═╝░░░╚═╝░░░░░░╚═╝░░░╚═╝░░╚═╝╚═╝╚═════╝░░╚═════╝░░░░╚═╝░░░╚═╝░╚════╝░╚═╝░░╚══╝░░░░░░
// 
// ███╗░░██╗░█████╗░███╗░░██╗░█████╗░░█████╗░███╗░░░███╗███╗░░░███╗███████╗██████╗░░█████╗░██╗░█████╗░██╗░░░░░
// ████╗░██║██╔══██╗████╗░██║██╔══██╗██╔══██╗████╗░████║████╗░████║██╔════╝██╔══██╗██╔══██╗██║██╔══██╗██║░░░░░
// ██╔██╗██║██║░░██║██╔██╗██║██║░░╚═╝██║░░██║██╔████╔██║██╔████╔██║█████╗░░██████╔╝██║░░╚═╝██║███████║██║░░░░░
// ██║╚████║██║░░██║██║╚████║██║░░██╗██║░░██║██║╚██╔╝██║██║╚██╔╝██║██╔══╝░░██╔══██╗██║░░██╗██║██╔══██║██║░░░░░
// ██║░╚███║╚█████╔╝██║░╚███║╚█████╔╝╚█████╔╝██║░╚═╝░██║██║░╚═╝░██║███████╗██║░░██║╚█████╔╝██║██║░░██║███████╗
// ╚═╝░░╚══╝░╚════╝░╚═╝░░╚══╝░╚════╝░░╚════╝░╚═╝░░░░░╚═╝╚═╝░░░░░╚═╝╚══════╝╚═╝░░╚═╝░╚════╝░╚═╝╚═╝░░╚═╝╚══════╝
// 
// ░░██╗██╗░░░░█████╗░
// ░██╔╝██║░░░██╔══██╗
// ██╔╝░██║░░░██║░░██║
// ███████║░░░██║░░██║
// ╚════██║██╗╚█████╔╝
// ░░░░░╚═╝╚═╝░╚════╝░
// 
// ██╗███╗░░██╗████████╗███████╗██████╗░███╗░░██╗░█████╗░████████╗██╗░█████╗░███╗░░██╗░█████╗░██╗░░░░░
// ██║████╗░██║╚══██╔══╝██╔════╝██╔══██╗████╗░██║██╔══██╗╚══██╔══╝██║██╔══██╗████╗░██║██╔══██╗██║░░░░░
// ██║██╔██╗██║░░░██║░░░█████╗░░██████╔╝██╔██╗██║███████║░░░██║░░░██║██║░░██║██╔██╗██║███████║██║░░░░░
// ██║██║╚████║░░░██║░░░██╔══╝░░██╔══██╗██║╚████║██╔══██║░░░██║░░░██║██║░░██║██║╚████║██╔══██║██║░░░░░
// ██║██║░╚███║░░░██║░░░███████╗██║░░██║██║░╚███║██║░░██║░░░██║░░░██║╚█████╔╝██║░╚███║██║░░██║███████╗
// ╚═╝╚═╝░░╚══╝░░░╚═╝░░░╚══════╝╚═╝░░╚═╝╚═╝░░╚══╝╚═╝░░╚═╝░░░╚═╝░░░╚═╝░╚════╝░╚═╝░░╚══╝╚═╝░░╚═╝╚══════╝
// 
// █─▄▄▄─█─▄▄▄─███▄─▄─▀█▄─█─▄█▀▀▀▀▀██▄─▀█▄─▄█─▄▄▄─███░█░██████─▄▄─█
// █─███▀█─███▀████─▄─▀██▄─▄██████████─█▄▀─██─███▀███▄▄░██░░██─██─█
// ▀▄▄▄▄▄▀▄▄▄▄▄▀▀▀▄▄▄▄▀▀▀▄▄▄▀▀▀▀▀▀▀▀▀▄▄▄▀▀▄▄▀▄▄▄▄▄▀▀▀▀▄▄▄▀▄▄▀▀▄▄▄▄▀
// 
// ▀█▀ █░█ █ █▀   █░░ █ █▀▀ █▀▀ █▄░█ █▀ █▀▀   █▀█ █▀▀ █▀█ █░█ █ █▀█ █▀▀ █▀   ▀█▀ █░█ ▄▀█ ▀█▀
// ░█░ █▀█ █ ▄█   █▄▄ █ █▄▄ ██▄ █░▀█ ▄█ ██▄   █▀▄ ██▄ ▀▀█ █▄█ █ █▀▄ ██▄ ▄█   ░█░ █▀█ █▀█ ░█░
// 
// █▀█ █▀▀ █░█ █▀ █▀▀ █▀█ █▀   █▀▀ █ █░█ █▀▀   █▀▀ █▀█ █▀▀ █▀▄ █ ▀█▀   ▀█▀ █▀█   ▀█▀ █░█ █▀▀
// █▀▄ ██▄ █▄█ ▄█ ██▄ █▀▄ ▄█   █▄█ █ ▀▄▀ ██▄   █▄▄ █▀▄ ██▄ █▄▀ █ ░█░   ░█░ █▄█   ░█░ █▀█ ██▄
// 
// █▀▀ █▀█ █▀▀ ▄▀█ ▀█▀ █▀█ █▀█ ░   █ ▀█▀   ▄▀█ █░░ █░░ █▀█ █░█░█ █▀   █▀█ █▀▀ █░█ █▀ █▀▀ █▀█ █▀   ▀█▀ █▀█
// █▄▄ █▀▄ ██▄ █▀█ ░█░ █▄█ █▀▄ ▄   █ ░█░   █▀█ █▄▄ █▄▄ █▄█ ▀▄▀▄▀ ▄█   █▀▄ ██▄ █▄█ ▄█ ██▄ █▀▄ ▄█   ░█░ █▄█
// 
// █▀▄ █ █▀ ▀█▀ █▀█ █ █▄▄ █░█ ▀█▀ █▀▀ ░   █▀█ █▀▀ █▀▄▀█ █ ▀▄▀ ░   ▄▀█ █▀▄ ▄▀█ █▀█ ▀█▀ ░   ▄▀█ █▄░█ █▀▄
// █▄▀ █ ▄█ ░█░ █▀▄ █ █▄█ █▄█ ░█░ ██▄ █   █▀▄ ██▄ █░▀░█ █ █░█ █   █▀█ █▄▀ █▀█ █▀▀ ░█░ █   █▀█ █░▀█ █▄▀
// 
// █▄▄ █░█ █ █░░ █▀▄   █░█ █▀█ █▀█ █▄░█   ▀█▀ █░█ █▀▀   █▀▄▀█ ▄▀█ ▀█▀ █▀▀ █▀█ █ ▄▀█ █░░   █ █▄░█   ▄▀█ █▄░█ █▄█
// █▄█ █▄█ █ █▄▄ █▄▀   █▄█ █▀▀ █▄█ █░▀█   ░█░ █▀█ ██▄   █░▀░█ █▀█ ░█░ ██▄ █▀▄ █ █▀█ █▄▄   █ █░▀█   █▀█ █░▀█ ░█░
// 
// █▀▄▀█ █▀▀ █▀▄ █ █░█ █▀▄▀█   █▀█ █▀█   █▀▀ █▀█ █▀█ █▀▄▀█ ▄▀█ ▀█▀ ░   █▀▀ █▀█ █▀█
// █░▀░█ ██▄ █▄▀ █ █▄█ █░▀░█   █▄█ █▀▄   █▀░ █▄█ █▀▄ █░▀░█ █▀█ ░█░ █   █▀░ █▄█ █▀▄
// 
// █▄░█ █▀█ █▄░█ █▀▀ █▀█ █▀▄▀█ █▀▄▀█ █▀▀ █▀█ █▀▀ █ ▄▀█ █░░   █▀█ █░█ █▀█ █▀█ █▀█ █▀ █▀▀ █▀   █▀█ █▄░█ █░░ █▄█ ░
// █░▀█ █▄█ █░▀█ █▄▄ █▄█ █░▀░█ █░▀░█ ██▄ █▀▄ █▄▄ █ █▀█ █▄▄   █▀▀ █▄█ █▀▄ █▀▀ █▄█ ▄█ ██▄ ▄█   █▄█ █░▀█ █▄▄ ░█░ ▄
// 